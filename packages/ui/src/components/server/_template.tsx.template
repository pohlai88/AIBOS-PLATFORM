/**
 * [SERVER_COMPONENT] - Server Component Template
 *
 * Environment: Server-Side Only (NO 'use client' directive)
 * MCP Validation: Enabled with server-specific markers
 * Design System: AI-BOS Tokens (server-safe imports only)
 * Accessibility: WCAG 2.1 AA/AAA compliant static rendering
 * Architecture: Next.js RSC Official Server Pattern
 *
 * @template Use this template for all server-side components
 * @version 2.0.0 - RSC Server Compliant
 * @mcp-validated true
 */

// NO 'use client' directive - Server Component by default

import * as React from 'react'

// Import design tokens (server-safe)
import {
  colorTokens,
  accessibilityTokens,
  radiusTokens,
  shadowTokens,
  spacingTokens,
  typographyTokens,
  componentTokens,
} from '../../design/tokens/tokens'
import { cn } from '../../design/utilities/cn'

// ðŸŽ¯ STEP 1: Define server component variant types
type [SERVER_COMPONENT]Variant = 'default' | 'primary' | 'secondary' | 'info'
type [SERVER_COMPONENT]Size = 'sm' | 'md' | 'lg' | 'xl'

// ðŸŽ¯ STEP 2: Create server-optimized variant system
const [SERVER_COMPONENT_LOWER]Variants = {
  base: [
    "relative", // Base positioning
    "mcp-server-safe", // MCP server validation marker
    // Add server-specific base styles here
  ].join(" "),
  variants: {
    variant: {
      default: [
        colorTokens.bgElevated,
        colorTokens.text,
        `border ${colorTokens.borderSubtle}`,
      ].join(" "),

      primary: [
        colorTokens.primarySurface,
        accessibilityTokens.textOnPrimary,
        shadowTokens.xs,
      ].join(" "),

      secondary: [
        colorTokens.secondarySoftSurface,
        colorTokens.textMuted,
        `border ${colorTokens.border}`,
      ].join(" "),

      info: [
        colorTokens.bgMuted,
        colorTokens.text,
        `border ${colorTokens.borderSubtle}`,
        shadowTokens.sm,
      ].join(" "),
    },
    size: {
      sm: [
        spacingTokens.sm,
        typographyTokens.bodySm,
        radiusTokens.sm,
      ].join(" "),
      md: [
        spacingTokens.md,
        typographyTokens.bodyMd,
        radiusTokens.md,
      ].join(" "),
      lg: [
        spacingTokens.lg,
        typographyTokens.headingMd,
        radiusTokens.lg,
      ].join(" "),
      xl: [
        spacingTokens.lg,
        typographyTokens.headingLg,
        radiusTokens.xl,
      ].join(" "),
    },
  },
}

// ðŸŽ¯ STEP 3: Define server component props interface
export interface [SERVER_COMPONENT]Props
  extends React.HTMLAttributes<HTMLDivElement> {
  /**
   * Visual variant of the component
   */
  variant?: [SERVER_COMPONENT]Variant

  /**
   * Size of the component
   */
  size?: [SERVER_COMPONENT]Size

  /**
   * Test ID for automated testing
   */
  testId?: string

  /**
   * Server-side data (can be complex objects, functions, etc.)
   * This will be serialized for client hydration
   */
  data?: any

  /**
   * Async loading state (server-rendered)
   */
  loading?: boolean

  /**
   * Error state (server-rendered)
   */
  error?: string | null
}

/**
 * [SERVER_COMPONENT] - Server-Side Component
 *
 * Features:
 * - Server-side rendering with optimal performance
 * - Direct data fetching and processing
 * - SEO-optimized static HTML generation
 * - Secure server-only operations
 * - Full WCAG 2.1 AA/AAA compliance
 * - MCP server validation enabled
 *
 * @example
 * ```tsx
 * // Basic server component usage
 * <[SERVER_COMPONENT] variant="primary">
 *   Static server content
 * </[SERVER_COMPONENT]>
 *
 * // With server-side data fetching
 * export default async function Page() {
 *   const data = await fetchServerData()
 *
 *   return (
 *     <[SERVER_COMPONENT]
 *       variant="primary"
 *       size="lg"
 *       data={data}
 *     >
 *       {data.title}
 *     </[SERVER_COMPONENT]>
 *   )
 * }
 *
 * // Error boundary pattern
 * <[SERVER_COMPONENT]
 *   variant="secondary"
 *   error={errorMessage}
 * >
 *   {errorMessage ? 'Error occurred' : 'Success content'}
 * </[SERVER_COMPONENT]>
 * ```
 */
export const [SERVER_COMPONENT] = React.forwardRef<HTMLDivElement, [SERVER_COMPONENT]Props>(
  (
    {
      className,
      variant = "default",
      size = "md",
      testId,
      data,
      loading = false,
      error = null,
      children,
      ...props
    },
    ref
  ) => {
    // ðŸŽ¯ STEP 4: Server-side logic (no hooks, no client APIs)
    // All logic here runs on the server during rendering

    // Build className from variant system
    const variantClasses =
      [SERVER_COMPONENT_LOWER]Variants.variants.variant[variant] ||
      [SERVER_COMPONENT_LOWER]Variants.variants.variant.default
    const sizeClasses =
      [SERVER_COMPONENT_LOWER]Variants.variants.size[size] ||
      [SERVER_COMPONENT_LOWER]Variants.variants.size.md

    // ðŸŽ¯ STEP 5: Server-side accessibility enhancements
    const accessibilityProps = {
      "data-testid": testId,
      "aria-busy": loading,
      "aria-invalid": !!error,
      // MCP Guardian: Server component compliance markers
      "data-mcp-validated": "true",
      "data-constitution-compliant": "[server-component]-static",
      "data-server-component": "true",
    }

    // ðŸŽ¯ STEP 6: Conditional rendering based on server state
    if (error) {
      return (
        <div
          ref={ref}
          className={cn(
            [SERVER_COMPONENT_LOWER]Variants.base,
            "border-red-200 bg-red-50 text-red-800",
            sizeClasses,
            className
          )}
          role="alert"
          {...accessibilityProps}
          {...props}
        >
          <div className="flex items-center gap-2">
            <svg className="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
              <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd" />
            </svg>
            <span>{error}</span>
          </div>
        </div>
      )
    }

    if (loading) {
      return (
        <div
          ref={ref}
          className={cn(
            [SERVER_COMPONENT_LOWER]Variants.base,
            variantClasses,
            sizeClasses,
            "animate-pulse",
            className
          )}
          {...accessibilityProps}
          {...props}
        >
          <div className="flex items-center gap-2">
            <div className="h-4 w-4 bg-current opacity-20 rounded-full animate-pulse" />
            <span className="opacity-70">Loading...</span>
          </div>
        </div>
      )
    }

    return (
      <div
        ref={ref}
        className={cn(
          [SERVER_COMPONENT_LOWER]Variants.base,
          variantClasses,
          sizeClasses,
          className
        )}
        {...accessibilityProps}
        {...props}
      >
        {/* ðŸŽ¯ STEP 7: Server-rendered content */}
        {children}

        {/* ðŸŽ¯ STEP 8: Optional data display (server-side only) */}
        {data && process.env.NODE_ENV === 'development' && (
          <details className="mt-2 text-xs opacity-50">
            <summary>Server Data (dev only)</summary>
            <pre className="mt-1 p-2 bg-gray-100 rounded text-xs overflow-auto">
              {JSON.stringify(data, null, 2)}
            </pre>
          </details>
        )}
      </div>
    )
  }
)

[SERVER_COMPONENT].displayName = "[SERVER_COMPONENT]"

// ðŸŽ¯ STEP 9: Export types for external consumption
export type { [SERVER_COMPONENT]Variant, [SERVER_COMPONENT]Size }
export { [SERVER_COMPONENT_LOWER]Variants }

// ðŸŽ¯ STEP 10: Default export for convenience
export default [SERVER_COMPONENT]

// ðŸŽ¯ STEP 11: Server Component Compliance Checklist
// âœ… NO 'use client' directive
// âœ… NO React hooks (useState, useEffect, useCallback, etc.)
// âœ… NO browser APIs (window, localStorage, document, etc.)
// âœ… NO event handlers (onClick, onChange, etc.)
// âœ… Server-side data processing allowed
// âœ… Async operations allowed (await, fetch, etc.)
// âœ… Design tokens used exclusively
// âœ… MCP server validation markers included
// âœ… Accessibility compliant for static content
// âœ… SEO optimized
// âœ… TypeScript strict mode compatible
